<html>
<body>
    <h1>トップページ</h1>

    <script type="text/javascript">

        function getQueryParams() {
            let params = {}
            let url = location.search.substring(1).split('&')

            for (var i = 0; i < url.length; i++) {
                let param = url[i].split('=')
                params[param[0]] = param[1]
            }

            return params
        }

        document.addEventListener('DOMContentLoaded', function () {
            // query param to object
            let params = getQueryParams()

            // if exist token, save to localstorage and redirect
            if (params.token) {
                localStorage.setItem('token', params.token)

                // concat query param exclude 'token'
                let url = ''
                for (let [key, value] of Object.entries(params)) {
                    if (key != 'token') {
                        url += key + '=' + value
                    }
                }
                if (url.length > 0) {
                    window.location.href = '/?' + url
                }
                else {
                    window.location.href = '/'
                }
            }
            
        });
    </script>
</body>
</html>

